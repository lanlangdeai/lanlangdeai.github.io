
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>常用类 · LanLang's Gitbook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="X-Wolf">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-prism/prism.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-page-footer-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-codeblock-filename/block.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-multipart/multipart.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-bootstrap-callout/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-theme-comscore/test.css">
                
            
        

    

    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="composer.html" />
    
    
    <link rel="prev" href="files.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                        <b>1.1.</b>
                    
                    简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="php.html">
            
                <a href="php.html">
            
                    
                        <b>1.2.</b>
                    
                    PHP
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="functions.html">
            
                <a href="functions.html">
            
                    
                        <b>1.2.1.</b>
                    
                    常用方法
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="files.html">
            
                <a href="files.html">
            
                    
                        <b>1.2.1.1.</b>
                    
                    文件类
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.2.2" data-path="classes.html">
            
                <a href="classes.html">
            
                    
                        <b>1.2.2.</b>
                    
                    常用类
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="composer.html">
            
                <a href="composer.html">
            
                    
                        <b>1.2.3.</b>
                    
                    第三方包
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../python/python.html">
            
                <a href="../python/python.html">
            
                    
                        <b>1.3.</b>
                    
                    Python
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../python/basics.html">
            
                <a href="../python/basics.html">
            
                    
                        <b>1.3.1.</b>
                    
                    基础语法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../python/functions.html">
            
                <a href="../python/functions.html">
            
                    
                        <b>1.3.2.</b>
                    
                    函数/方法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../python/cases.html">
            
                <a href="../python/cases.html">
            
                    
                        <b>1.3.3.</b>
                    
                    示例
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../python/packages.html">
            
                <a href="../python/packages.html">
            
                    
                        <b>1.3.4.</b>
                    
                    第三方包
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../golang/golang.html">
            
                <a href="../golang/golang.html">
            
                    
                        <b>1.4.</b>
                    
                    Golang
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../linux/linux.html">
            
                <a href="../linux/linux.html">
            
                    
                        <b>1.5.</b>
                    
                    Linux
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../linux/commands.html">
            
                <a href="../linux/commands.html">
            
                    
                        <b>1.5.1.</b>
                    
                    常用命令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../linux/scripts.html">
            
                <a href="../linux/scripts.html">
            
                    
                        <b>1.5.2.</b>
                    
                    常用脚本
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../linux/supervisor.html">
            
                <a href="../linux/supervisor.html">
            
                    
                        <b>1.5.3.</b>
                    
                    Supervisor
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../mysql/mysql.html">
            
                <a href="../mysql/mysql.html">
            
                    
                        <b>1.6.</b>
                    
                    MySQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../docker/docker.html">
            
                <a href="../docker/docker.html">
            
                    
                        <b>1.7.</b>
                    
                    Docker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../apache/apache.html">
            
                <a href="../apache/apache.html">
            
                    
                        <b>1.8.</b>
                    
                    Apache
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../nginx/nginx.html">
            
                <a href="../nginx/nginx.html">
            
                    
                        <b>1.9.</b>
                    
                    Nginx
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../nginx/install.html">
            
                <a href="../nginx/install.html">
            
                    
                        <b>1.9.1.</b>
                    
                    安装篇
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../nginx/config.html">
            
                <a href="../nginx/config.html">
            
                    
                        <b>1.9.2.</b>
                    
                    配置篇
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../elasticsearch/elasticsearch.html">
            
                <a href="../elasticsearch/elasticsearch.html">
            
                    
                        <b>1.10.</b>
                    
                    Elasticsearch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../memcache/memecache.html">
            
                <a href="../memcache/memecache.html">
            
                    
                        <b>1.11.</b>
                    
                    Memcache
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../mongodb/mongodb.html">
            
                <a href="../mongodb/mongodb.html">
            
                    
                        <b>1.12.</b>
                    
                    MongoDB
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../mongodb/scripts.html">
            
                <a href="../mongodb/scripts.html">
            
                    
                        <b>1.12.1.</b>
                    
                    脚本汇总
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../redis/redis.html">
            
                <a href="../redis/redis.html">
            
                    
                        <b>1.13.</b>
                    
                    Redis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../nodejs/nodejs.html">
            
                <a href="../nodejs/nodejs.html">
            
                    
                        <b>1.14.</b>
                    
                    Nodejs
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../nodejs/install.html">
            
                <a href="../nodejs/install.html">
            
                    
                        <b>1.14.1.</b>
                    
                    安装篇
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../developer/developer.html">
            
                <a href="../developer/developer.html">
            
                    
                        <b>1.15.</b>
                    
                    开发者工具
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="../developer/webs.html">
            
                <a href="../developer/webs.html">
            
                    
                        <b>1.15.1.</b>
                    
                    技术站点
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.2" data-path="../developer/softwares.html">
            
                <a href="../developer/softwares.html">
            
                    
                        <b>1.15.2.</b>
                    
                    常用软件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.3" data-path="../developer/sources.html">
            
                <a href="../developer/sources.html">
            
                    
                        <b>1.15.3.</b>
                    
                    资源库
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="../project/project.html">
            
                <a href="../project/project.html">
            
                    
                        <b>1.16.</b>
                    
                    项目
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="../project/files.html">
            
                <a href="../project/files.html">
            
                    
                        <b>1.16.1.</b>
                    
                    项目文件
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="../common/donate.html">
            
                <a href="../common/donate.html">
            
                    
                        <b>1.17.</b>
                    
                    赞赏
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >常用类</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#&#x5E38;&#x7528;&#x7C7B;"><b>1.2.2. </b>&#x5E38;&#x7528;&#x7C7B;</a></li><ul><li><span class="title-icon "></span><a href="#1---&#x81EA;&#x5C01;&#x88C5;--"><b>1.2.2.1. </b>1. ===============  &#x81EA;&#x5C01;&#x88C5;  ===============</a></li><ul><li><span class="title-icon "></span><a href="#&#x6587;&#x4EF6;&#x5904;&#x7406;&#xFF08;&#x4E0A;&#x4F20;&#x4E0B;&#x8F7D;&#xFF09;"><b>1.2.2.1.1. </b>&#x6587;&#x4EF6;&#x5904;&#x7406;&#xFF08;&#x4E0A;&#x4F20;/&#x4E0B;&#x8F7D;&#xFF09;</a></li><li><span class="title-icon "></span><a href="#&#x5B57;&#x7B26;&#x4E32;&#x52A0;&#x89E3;&#x5BC6;"><b>1.2.2.1.2. </b>&#x5B57;&#x7B26;&#x4E32;&#x52A0;&#x89E3;&#x5BC6;</a></li><li><span class="title-icon "></span><a href="#&#x5B57;&#x7B26;&#x4E32;&#x52A0;&#x89E3;&#x5BC6;2"><b>1.2.2.1.3. </b>&#x5B57;&#x7B26;&#x4E32;&#x52A0;&#x89E3;&#x5BC6;2</a></li></ul><li><span class="title-icon "></span><a href="#2--&#x57FA;&#x4E8E;&#x7B2C;&#x4E09;&#x65B9;&#x5E93;--"><b>1.2.2.2. </b>2.=====================  &#x57FA;&#x4E8E;&#x7B2C;&#x4E09;&#x65B9;&#x5E93;  ====================</a></li></ul></ul></div><a href="#&#x5E38;&#x7528;&#x7C7B;" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="&#x5E38;&#x7528;&#x7C7B;"><a name="&#x5E38;&#x7528;&#x7C7B;" class="anchor-navigation-ex-anchor" href="#&#x5E38;&#x7528;&#x7C7B;"><i class="fa fa-link" aria-hidden="true"></i></a>1.2.2. &#x5E38;&#x7528;&#x7C7B;</h1>
<h2 id="1---&#x81EA;&#x5C01;&#x88C5;--"><a name="1---&#x81EA;&#x5C01;&#x88C5;--" class="anchor-navigation-ex-anchor" href="#1---&#x81EA;&#x5C01;&#x88C5;--"><i class="fa fa-link" aria-hidden="true"></i></a>1.2.2.1. 1. ===============  &#x81EA;&#x5C01;&#x88C5;  ===============</h2>
<ul>
<li><h4 id="&#x83B7;&#x53D6;&#x5BA2;&#x6237;&#x7AEF;&#x4EE3;&#x7406;&#x4FE1;&#x606F;"><a name="&#x83B7;&#x53D6;&#x5BA2;&#x6237;&#x7AEF;&#x4EE3;&#x7406;&#x4FE1;&#x606F;" class="anchor-navigation-ex-anchor" href="#&#x83B7;&#x53D6;&#x5BA2;&#x6237;&#x7AEF;&#x4EE3;&#x7406;&#x4FE1;&#x606F;"><i class="fa fa-link" aria-hidden="true"></i></a><a name="&#x83B7;&#x53D6;&#x5BA2;&#x6237;&#x7AEF;&#x4EE3;&#x7406;&#x4FE1;&#x606F;" class="plugin-anchor" href="#&#x83B7;&#x53D6;&#x5BA2;&#x6237;&#x7AEF;&#x4EE3;&#x7406;&#x4FE1;&#x606F;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x83B7;&#x53D6;&#x5BA2;&#x6237;&#x7AEF;&#x4EE3;&#x7406;&#x4FE1;&#x606F;</h4>
</li>
</ul>
<pre class="language-"><code class="lang-php"><span class="token delimiter important">&lt;?php</span>


<span class="token comment">//------------------------</span>
<span class="token comment">// &#x6839;&#x636E;user-agent&#x83B7;&#x53D6;&#x6D4F;&#x89C8;&#x5668;&#x7248;&#x672C;&#xFF0C;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;</span>
<span class="token comment">//-------------------------</span>

<span class="token keyword">class</span> <span class="token class-name">Agent</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * &#x83B7;&#x53D6;&#x5BA2;&#x6237;&#x7AEF;&#x6D4F;&#x89C8;&#x5668;&#x4FE1;&#x606F; &#x6DFB;&#x52A0;win10 edge&#x6D4F;&#x89C8;&#x5668;&#x5224;&#x65AD;
     * @param  null
     * @author  Jea&#x6768;
     * @return string
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">getBroswer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$sys</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&apos;HTTP_USER_AGENT&apos;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//&#x83B7;&#x53D6;&#x7528;&#x6237;&#x4EE3;&#x7406;&#x5B57;&#x7B26;&#x4E32;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$sys</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;Firefox/&quot;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;/Firefox\/([^;)]+)+/i&quot;</span><span class="token punctuation">,</span> <span class="token variable">$sys</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;Firefox&quot;</span><span class="token punctuation">;</span>
            <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$b</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//&#x83B7;&#x53D6;&#x706B;&#x72D0;&#x6D4F;&#x89C8;&#x5668;&#x7684;&#x7248;&#x672C;&#x53F7;</span>
        <span class="token punctuation">}</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$sys</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;Maxthon&quot;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;/Maxthon\/([\d\.]+)/&quot;</span><span class="token punctuation">,</span> <span class="token variable">$sys</span><span class="token punctuation">,</span> <span class="token variable">$aoyou</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;&#x50B2;&#x6E38;&quot;</span><span class="token punctuation">;</span>
            <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$aoyou</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$sys</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;MSIE&quot;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;/MSIE\s+([^;)]+)+/i&quot;</span><span class="token punctuation">,</span> <span class="token variable">$sys</span><span class="token punctuation">,</span> <span class="token variable">$ie</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;IE&quot;</span><span class="token punctuation">;</span>
            <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$ie</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//&#x83B7;&#x53D6;IE&#x7684;&#x7248;&#x672C;&#x53F7;</span>
        <span class="token punctuation">}</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$sys</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;OPR&quot;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;/OPR\/([\d\.]+)/&quot;</span><span class="token punctuation">,</span> <span class="token variable">$sys</span><span class="token punctuation">,</span> <span class="token variable">$opera</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;Opera&quot;</span><span class="token punctuation">;</span>
            <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$opera</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$sys</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;Edge&quot;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//win10 Edge&#x6D4F;&#x89C8;&#x5668; &#x6DFB;&#x52A0;&#x4E86;chrome&#x5185;&#x6838;&#x6807;&#x8BB0; &#x5728;&#x5224;&#x65AD;Chrome&#x4E4B;&#x524D;&#x5339;&#x914D;</span>
            <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;/Edge\/([\d\.]+)/&quot;</span><span class="token punctuation">,</span> <span class="token variable">$sys</span><span class="token punctuation">,</span> <span class="token variable">$Edge</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;Edge&quot;</span><span class="token punctuation">;</span>
            <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$Edge</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$sys</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;Chrome&quot;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;/Chrome\/([\d\.]+)/&quot;</span><span class="token punctuation">,</span> <span class="token variable">$sys</span><span class="token punctuation">,</span> <span class="token variable">$google</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;Chrome&quot;</span><span class="token punctuation">;</span>
            <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$google</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//&#x83B7;&#x53D6;google chrome&#x7684;&#x7248;&#x672C;&#x53F7;</span>
        <span class="token punctuation">}</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$sys</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;rv:&apos;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$sys</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;Gecko&apos;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;/rv:([\d\.]+)/&quot;</span><span class="token punctuation">,</span> <span class="token variable">$sys</span><span class="token punctuation">,</span> <span class="token variable">$IE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;IE&quot;</span><span class="token punctuation">;</span>
            <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$IE</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$sys</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;Safari&apos;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;/safari\/([^\s]+)/i&quot;</span><span class="token punctuation">,</span> <span class="token variable">$sys</span><span class="token punctuation">,</span> <span class="token variable">$safari</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;Safari&quot;</span><span class="token punctuation">;</span>
            <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$safari</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;&#x672A;&#x77E5;&#x6D4F;&#x89C8;&#x5668;&quot;</span><span class="token punctuation">;</span>
            <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&apos;(&apos;</span> <span class="token operator">.</span> <span class="token variable">$exp</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&apos;)&apos;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * &#x83B7;&#x53D6;&#x5BA2;&#x6237;&#x7AEF;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4FE1;&#x606F;&#x5305;&#x62EC;win10
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">getOs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$agent</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&apos;HTTP_USER_AGENT&apos;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/win/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$agent</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;95&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;Windows 95&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/win 9x/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$agent</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;4.90&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;Windows ME&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/win/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/98/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;Windows 98&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/win/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/nt 6.0/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;Windows Vista&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/win/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/nt 6.1/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;Windows 7&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/win/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/nt 6.2/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;Windows 8&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/win/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/nt 10.0/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;Windows 10&apos;</span><span class="token punctuation">;</span><span class="token comment">#&#x6DFB;&#x52A0;win10&#x5224;&#x65AD;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/win/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/nt 5.1/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;Windows XP&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/win/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/nt 5/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;Windows 2000&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/win/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/nt/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;Windows NT&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/win/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/32/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;Windows 32&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/linux/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;Linux&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/unix/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;Unix&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/sun/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/os/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;SunOS&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/ibm/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/os/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;IBM OS/2&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/Mac/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;Mac&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/PowerPC/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;PowerPC&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/AIX/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;AIX&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/HPUX/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;HPUX&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/NetBSD/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;NetBSD&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/BSD/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;BSD&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/OSF1/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;OSF1&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/IRIX/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;IRIX&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/FreeBSD/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;FreeBSD&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/teleport/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;teleport&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/flashget/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;flashget&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/webzip/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;webzip&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/offline/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;offline&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/ucweb|MQQBrowser|J2ME|IUC|3GW100|LG-MMS|i60|Motorola|MAUI|m9|ME860|maui|C8500|gt|k-touch|X8|htc|GT-S5660|UNTRUSTED|SCH|tianyu|lenovo|SAMSUNG/i&apos;</span><span class="token punctuation">,</span> <span class="token variable">$agent</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;mobile&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token variable">$os</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;&#x672A;&#x77E5;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&apos;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token variable">$os</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li><h3 id="&#x6587;&#x4EF6;&#x5904;&#x7406;&#xFF08;&#x4E0A;&#x4F20;&#x4E0B;&#x8F7D;&#xFF09;"><a name="&#x6587;&#x4EF6;&#x5904;&#x7406;&#xFF08;&#x4E0A;&#x4F20;&#x4E0B;&#x8F7D;&#xFF09;" class="anchor-navigation-ex-anchor" href="#&#x6587;&#x4EF6;&#x5904;&#x7406;&#xFF08;&#x4E0A;&#x4F20;&#x4E0B;&#x8F7D;&#xFF09;"><i class="fa fa-link" aria-hidden="true"></i></a>1.2.2.1.1. &#x6587;&#x4EF6;&#x5904;&#x7406;&#xFF08;&#x4E0A;&#x4F20;/&#x4E0B;&#x8F7D;&#xFF09;</h3>
</li>
</ul>
<pre class="language-"><code class="lang-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">//------------------------</span>
<span class="token comment">// &#x6587;&#x4EF6;&#x4E0B;&#x8F7D;&#x548C;&#x56FE;&#x7247;&#x4E0B;&#x8F7D;</span>
<span class="token comment">//-------------------------</span>

<span class="token keyword">class</span> <span class="token class-name">File</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * &#x6587;&#x4EF6;&#x4E0B;&#x8F7D;
     * @param $file_path
     * @param string $file_name
     * @param string $file_size
     * @param string $ext
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">download</span><span class="token punctuation">(</span><span class="token variable">$file_path</span><span class="token punctuation">,</span> <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;&apos;</span><span class="token punctuation">,</span> <span class="token variable">$file_size</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;&apos;</span><span class="token punctuation">,</span> <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;&apos;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$file_name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">basename</span><span class="token punctuation">(</span><span class="token variable">$file_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$file_size</span> <span class="token operator">&amp;&amp;</span> <span class="token function">in_array</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$file_path</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;/&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token variable">$file_size</span> <span class="token operator">=</span> <span class="token function">filesize</span><span class="token punctuation">(</span><span class="token variable">$file_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">//                return $e-&gt;getMessage();</span>
                <span class="token keyword">return</span> <span class="token string double-quoted-string">&quot;&#x6587;&#x4EF6;&#x4E0D;&#x5B58;&#x5728;&quot;</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$ext</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">pathinfo</span><span class="token punctuation">(</span><span class="token variable">$file_path</span><span class="token punctuation">,</span> <span class="token constant">PATHINFO_EXTENSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$ext</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token variable">$file_name</span> <span class="token operator">.</span> <span class="token string double-quoted-string">&quot;.&quot;</span> <span class="token operator">.</span> <span class="token variable">$ext</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token variable">$content_type</span> <span class="token operator">=</span> <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token function">getMime</span><span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Cache-Control:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Cache-Control: public&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// &#x6587;&#x4EF6;&#x7C7B;&#x578B;</span>
        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Content-type: <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$content_type</span><span class="token punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// &#x5904;&#x7406;&#x4E2D;&#x6587;&#x6587;&#x4EF6;&#x540D;</span>
        <span class="token variable">$ua</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;HTTP_USER_AGENT&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;/MSIE/&quot;</span><span class="token punctuation">,</span> <span class="token variable">$ua</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$encoded_filename</span> <span class="token operator">=</span> <span class="token function">rawurlencode</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;Content-Disposition: attachment; filename=&quot;&apos;</span> <span class="token operator">.</span> <span class="token variable">$encoded_filename</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&apos;&quot;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;/Firefox/&quot;</span><span class="token punctuation">,</span> <span class="token variable">$ua</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Content-Disposition: attachment; filename*=\&quot;utf8&apos;&apos;&quot;</span> <span class="token operator">.</span> <span class="token variable">$file_name</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&apos;&quot;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;Content-Disposition: attachment; filename=&quot;&apos;</span> <span class="token operator">.</span> <span class="token variable">$file_name</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&apos;&quot;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// &#x6587;&#x4EF6;&#x5927;&#x5C0F;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$file_size</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Accept-Length: &quot;</span><span class="token operator">.</span> <span class="token variable">$file_size</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Content-Length: &quot;</span> <span class="token operator">.</span> <span class="token variable">$file_size</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">readfile</span><span class="token punctuation">(</span><span class="token variable">$file_path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * &#x529F;&#x80FD;&#xFF1A;php&#x591A;&#x79CD;&#x65B9;&#x5F0F;&#x5B8C;&#x7F8E;&#x5B9E;&#x73B0;&#x4E0B;&#x8F7D;&#x8FDC;&#x7A0B;&#x56FE;&#x7247;&#x4FDD;&#x5B58;&#x5230;&#x672C;&#x5730;
     * &#x53C2;&#x6570;&#xFF1A;&#x6587;&#x4EF6;url,&#x4FDD;&#x5B58;&#x6587;&#x4EF6;&#x540D;&#x79F0;&#xFF0C;&#x4F7F;&#x7528;&#x7684;&#x4E0B;&#x8F7D;&#x65B9;&#x5F0F;
     * &#x5F53;&#x4FDD;&#x5B58;&#x6587;&#x4EF6;&#x540D;&#x79F0;&#x4E3A;&#x7A7A;&#x65F6;&#x5219;&#x4F7F;&#x7528;&#x8FDC;&#x7A0B;&#x6587;&#x4EF6;&#x539F;&#x6765;&#x7684;&#x540D;&#x79F0;
     * @param string $url      &#x8BF7;&#x6C42;&#x56FE;&#x7247;&#x7684;&#x94FE;&#x63A5;
     * @param string $filename &#x4FDD;&#x5B58;&#x7684;&#x6587;&#x4EF6;&#x540D;
     * @param int $type        &#x4FDD;&#x5B58;&#x56FE;&#x7247;&#x7684;&#x7C7B;&#x578B; 0&#x4E3A;curl,&#x9002;&#x7528;&#x4E8E;&#x9759;&#x6001;&#x56FE;&#x7247;,&#x5176;&#x4ED6;&#x4E3A;&#x7F13;&#x51B2;&#x7F13;&#x5B58;,&#x9002;&#x7528;&#x4E8E;&#x52A8;&#x6001;&#x56FE;&#x7247;
     * @return string $filename &#x8FD4;&#x56DE;&#x4FDD;&#x5B58;&#x7684;&#x6587;&#x4EF6;&#x540D;
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">downloadImage</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">,</span> <span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$type</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$url</span> <span class="token operator">==</span> <span class="token string single-quoted-string">&apos;&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">pathinfo</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token constant">PATHINFO_EXTENSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&apos;jpg&apos;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;jpeg&apos;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;png&apos;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;gif&apos;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;bmp&apos;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;ico&apos;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;tif&apos;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;tiff&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">pathinfo</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">,</span> <span class="token constant">PATHINFO_EXTENSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&apos;jpg&apos;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;jpeg&apos;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;png&apos;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;gif&apos;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;bmp&apos;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;ico&apos;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;tif&apos;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;tiff&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;jpg&apos;</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$filename</span> <span class="token operator">.</span> <span class="token string double-quoted-string">&quot;.&quot;</span> <span class="token operator">.</span> <span class="token variable">$ext</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//&#x4E0B;&#x8F7D;&#x6587;&#x4EF6;&#x6D41;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$timeout</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
            <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_CONNECTTIMEOUT</span><span class="token punctuation">,</span> <span class="token variable">$timeout</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$img</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">ob_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">readfile</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$img</span> <span class="token operator">=</span> <span class="token function">ob_get_contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">ob_end_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//&#x4FDD;&#x5B58;&#x6587;&#x4EF6;</span>
<span class="token comment">//        try {</span>
            <span class="token variable">$fp2</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;w&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$fp2</span><span class="token punctuation">,</span> <span class="token variable">$img</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$fp2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>
        <span class="token comment">/*} catch (\think\Exception $e) {
            //TODO &#x5F02;&#x5E38;&#x5904;&#x7406;
            return false;
        }*/</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * &#x83B7;&#x53D6;&#x6587;&#x4EF6;Mime
     * @param string $ext
     * @return string
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">getMime</span><span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$mimes</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">&apos;xml&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;text/xml&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;json&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/json&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;js&apos;</span>    <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;text/javascript&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;php&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/octet-stream&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;css&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;text/css&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;html&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;text/html&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;htm&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;text/html&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;xhtml&apos;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;text/html&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;rss&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/rss+xml&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;yaml&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/x-yaml&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;atom&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/atom+xml&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;pdf&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/pdf&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;text&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;text/plain&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;png&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;image/png&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;jpg&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;image/jpeg&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;gif&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;image/gif&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;csv&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;text/csv&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;tif&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;image/tiff&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;ai&apos;</span>    <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/postscript&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;asp&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;text/asp&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;au&apos;</span>    <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;audio/basic&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;avi&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;video/avi&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;rmvb&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.rn-realmedia-vbr&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;3gp&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/octet-stream&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;flv&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/octet-stream&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;mp3&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;audio/mpeg&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;wav&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;audio/wav&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;sql&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/octet-stream&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;rar&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/octet-stream&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;zip&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/zip&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;7z&apos;</span>    <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/octet-stream&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;bmp&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/x-bmp&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;cdr&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/x-cdr&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;class&apos;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;java/*&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;exe&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/x-msdownload&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;fax&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;image/fax&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;icb&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/x-icb&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;ico&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;image/x-icon&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;java&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;java/*&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;jfif&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;image/jpeg&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;jpeg&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;image/jpeg&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;jsp&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;text/html&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;mp4&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;video/mpeg4&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;mpa&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;video/x-mpg&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;mpeg&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;video/mpg&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;mpg&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;video/mpg&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;mpga&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;audio/rn-mpeg&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;ras&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/x-ras&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;tiff&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;image/tiff&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;txt&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;text/plain&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;wax&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;audio/x-ms-wax&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;wm&apos;</span>    <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;video/x-ms-wm&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;apk&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.android.package-archive&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;doc&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/msword&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;dot&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/msword&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;docx&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.openxmlformats-officedocument.wordprocessingml.document&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;dotx&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.openxmlformats-officedocument.wordprocessingml.template&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;docm&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.ms-word.document.macroEnabled.12&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;dotm&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.ms-word.template.macroEnabled.12&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;xls&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.ms-excel&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;xlt&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.ms-excel&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;xla&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.ms-excel&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;xlsx&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;xltx&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.openxmlformats-officedocument.spreadsheetml.template&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;xlsm&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.ms-excel.sheet.macroEnabled.12&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;xltm&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.ms-excel.template.macroEnabled.12&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;xlam&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.ms-excel.addin.macroEnabled.12&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;xlsb&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.ms-excel.sheet.binary.macroEnabled.12&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;ppt&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.ms-powerpoint&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;pot&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.ms-powerpoint&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;pps&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.ms-powerpoint&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;ppa&apos;</span>   <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.ms-powerpoint&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;pptx&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.openxmlformats-officedocument.presentationml.presentation&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;potx&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.openxmlformats-officedocument.presentationml.template&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;ppsx&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.openxmlformats-officedocument.presentationml.slideshow&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;ppam&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.ms-powerpoint.addin.macroEnabled.12&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;pptm&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.ms-powerpoint.presentation.macroEnabled.12&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;potm&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.ms-powerpoint.template.macroEnabled.12&apos;</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">&apos;ppsm&apos;</span>  <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.ms-powerpoint.slideshow.macroEnabled.12&apos;</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$mimes</span><span class="token punctuation">[</span><span class="token variable">$ext</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$mimes</span><span class="token punctuation">[</span><span class="token variable">$ext</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">&apos;application/octet-stream&apos;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li><h3 id="&#x5B57;&#x7B26;&#x4E32;&#x52A0;&#x89E3;&#x5BC6;"><a name="&#x5B57;&#x7B26;&#x4E32;&#x52A0;&#x89E3;&#x5BC6;" class="anchor-navigation-ex-anchor" href="#&#x5B57;&#x7B26;&#x4E32;&#x52A0;&#x89E3;&#x5BC6;"><i class="fa fa-link" aria-hidden="true"></i></a>1.2.2.1.2. &#x5B57;&#x7B26;&#x4E32;&#x52A0;&#x89E3;&#x5BC6;</h3>
</li>
</ul>
<pre class="language-"><code class="lang-php"><span class="token keyword">class</span> Encrypt
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * &#x52A0;&#x5BC6;
     * @param  string  $str    &#x9700;&#x52A0;&#x5BC6;&#x5B57;&#x7B26;&#x4E32;
     * @param  integer $factor &#x5206;&#x7C7B;
     * @return string          &#x52A0;&#x5BC6;&#x4E4B;&#x540E;&#x7684;&#x5B57;&#x7B26;&#x4E32;
     */</span>
    <span class="token keyword">static</span> <span class="token keyword">function</span>  <span class="token function">doEncode</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$str</span> <span class="token punctuation">,</span> <span class="token keyword type-hint">int</span> <span class="token variable">$factor</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token variable">$len</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$len</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$factor</span>  <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token variable">$factor</span> <span class="token operator">=</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token number">255</span> <span class="token punctuation">,</span> <span class="token function">ceil</span><span class="token punctuation">(</span><span class="token variable">$len</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$factor</span> <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">;</span>

        <span class="token variable">$slice</span> <span class="token operator">=</span> <span class="token function">str_split</span><span class="token punctuation">(</span><span class="token variable">$str</span> <span class="token punctuation">,</span><span class="token variable">$factor</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$slice</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$j</span><span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$slice</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">;</span><span class="token variable">$j</span> <span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token variable">$slice</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$j</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$slice</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$j</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token variable">$c</span> <span class="token operator">+</span> <span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token function">pack</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;C&apos;</span> <span class="token punctuation">,</span> <span class="token variable">$factor</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">implode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;&apos;</span> <span class="token punctuation">,</span> <span class="token variable">$slice</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token function">base64URLEncode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * &#x89E3;&#x5BC6;
     * @param  string $str &#x9700;&#x89E3;&#x5BC6;&#x5B57;&#x7B26;&#x4E32;
     * @return string      &#x89E3;&#x5BC6;&#x4E4B;&#x540E;&#x7684;&#x5B57;&#x7B26;&#x4E32;
     */</span>
    <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">doDecode</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>  
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$str</span> <span class="token operator">==</span> <span class="token string single-quoted-string">&apos;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>     
        <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token function">base64URLDecode</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$factor</span> <span class="token operator">=</span>  <span class="token function">ord</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$str</span> <span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$factor</span> <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">;</span>
        <span class="token variable">$entity</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$str</span> <span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token variable">$slice</span> <span class="token operator">=</span> <span class="token function">str_split</span><span class="token punctuation">(</span><span class="token variable">$entity</span> <span class="token punctuation">,</span> <span class="token variable">$factor</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$slice</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$slice</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$j</span> <span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">;</span> <span class="token variable">$j</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$slice</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$j</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token variable">$slice</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$j</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$slice</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$j</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token variable">$c</span> <span class="token operator">-</span> <span class="token variable">$i</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token function">implode</span><span class="token punctuation">(</span><span class="token variable">$slice</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">base64URLEncode</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">rtrim</span><span class="token punctuation">(</span><span class="token function">strtr</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;+/&apos;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;-_&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;=&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">base64URLDecode</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span> 
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token function">str_pad</span><span class="token punctuation">(</span><span class="token function">strtr</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;-_&apos;</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;+/&apos;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;=&apos;</span><span class="token punctuation">,</span> <span class="token constant">STR_PAD_RIGHT</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li><h3 id="&#x5B57;&#x7B26;&#x4E32;&#x52A0;&#x89E3;&#x5BC6;2"><a name="&#x5B57;&#x7B26;&#x4E32;&#x52A0;&#x89E3;&#x5BC6;2" class="anchor-navigation-ex-anchor" href="#&#x5B57;&#x7B26;&#x4E32;&#x52A0;&#x89E3;&#x5BC6;2"><i class="fa fa-link" aria-hidden="true"></i></a>1.2.2.1.3. &#x5B57;&#x7B26;&#x4E32;&#x52A0;&#x89E3;&#x5BC6;2</h3>
</li>
</ul>
<pre class="language-"><code class="lang-php"><span class="token keyword">class</span> EncryptAndDecrypt
<span class="token punctuation">{</span>

    <span class="token comment">/**
     * &#x52A0;&#x89E3;&#x5BC6;&#x7B97;&#x6CD5;
     * @param  string $string &#x52A0;&#x5BC6;&#x6570;&#x636E;
     * @param  string $rand   &#x52A0;&#x5BC6;&#x968F;&#x673A;&#x5B57;&#x7B26;&#x4E32;
     * @param  string $action &#x52A0;&#x89E3;&#x5BC6;&#x65B9;&#x5F0F;&#x6807;&#x8BC6;
     * @return string         &#x52A0;&#x89E3;&#x5BC6;&#x4E4B;&#x540E;&#x6570;&#x636E;
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">mymd5</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">,</span> <span class="token variable">$rand</span><span class="token operator">=</span><span class="token string single-quoted-string">&apos;randstring&apos;</span><span class="token punctuation">,</span> <span class="token variable">$action</span><span class="token operator">=</span><span class="token string double-quoted-string">&quot;EN&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$secret_string</span> <span class="token operator">=</span> <span class="token variable">$rand</span><span class="token operator">.</span><span class="token string single-quoted-string">&apos;5*a,.^&amp;;?.%#@!&apos;</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token operator">==</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token operator">==</span><span class="token string double-quoted-string">&quot;EN&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token variable">$md5code</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token variable">$md5code</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$string</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//$key = md5($md5code.$_SERVER[&quot;HTTP_USER_AGENT&quot;].$secret_string);</span>
        <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$md5code</span><span class="token operator">.</span><span class="token variable">$secret_string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$string</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$action</span><span class="token operator">==</span><span class="token string double-quoted-string">&quot;EN&quot;</span> <span class="token operator">?</span> <span class="token variable">$string</span> <span class="token punctuation">:</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$len</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$code</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token variable">$k</span> <span class="token operator">=</span> <span class="token variable">$i</span><span class="token operator">%</span><span class="token variable">$len</span><span class="token punctuation">;</span>
            <span class="token variable">$code</span> <span class="token operator">.=</span> <span class="token variable">$string</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token variable">$key</span><span class="token punctuation">[</span><span class="token variable">$k</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token variable">$code</span> <span class="token operator">=</span> <span class="token variable">$action</span> <span class="token operator">==</span> <span class="token string double-quoted-string">&quot;DE&quot;</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token variable">$md5code</span> <span class="token operator">?</span> <span class="token variable">$code</span> <span class="token punctuation">:</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token class-name return-type">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;<span class="token interpolation"><span class="token variable">$md5code</span></span>&quot;</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token variable">$code</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// base64_encode</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">b64encode</span><span class="token punctuation">(</span> <span class="token variable">$string</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span> <span class="token variable">$string</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span> <span class="token keyword">array</span> <span class="token punctuation">(</span> <span class="token string single-quoted-string">&apos;+&apos;</span> <span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;/&apos;</span> <span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;=&apos;</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">array</span> <span class="token punctuation">(</span> <span class="token string single-quoted-string">&apos;-&apos;</span> <span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;_&apos;</span> <span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;&apos;</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$data</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$data</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// base64_decode</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">b64decode</span><span class="token punctuation">(</span> <span class="token variable">$string</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span> <span class="token keyword">array</span> <span class="token punctuation">(</span> <span class="token string single-quoted-string">&apos;-&apos;</span> <span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;_&apos;</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">array</span> <span class="token punctuation">(</span> <span class="token string single-quoted-string">&apos;+&apos;</span> <span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;/&apos;</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$string</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$mod4</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span> <span class="token variable">$data</span> <span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token variable">$mod4</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$data</span> <span class="token operator">.=</span> <span class="token function">substr</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">&apos;====&apos;</span><span class="token punctuation">,</span> <span class="token variable">$mod4</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span> <span class="token variable">$data</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre>
<hr>
<h2 id="2--&#x57FA;&#x4E8E;&#x7B2C;&#x4E09;&#x65B9;&#x5E93;--"><a name="2--&#x57FA;&#x4E8E;&#x7B2C;&#x4E09;&#x65B9;&#x5E93;--" class="anchor-navigation-ex-anchor" href="#2--&#x57FA;&#x4E8E;&#x7B2C;&#x4E09;&#x65B9;&#x5E93;--"><i class="fa fa-link" aria-hidden="true"></i></a>1.2.2.2. 2.=====================  &#x57FA;&#x4E8E;&#x7B2C;&#x4E09;&#x65B9;&#x5E93;  ====================</h2>
<ul>
<li>PHPExcel&#xFF08;<a href="https://github.com/PHPOffice/PHPExcel&#xFF09;" target="_blank">https://github.com/PHPOffice/PHPExcel&#xFF09;</a></li>
</ul>
<pre class="language-"><code class="lang-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">require_once</span> <span class="token string single-quoted-string">&apos;./PHPExcel/IOFactory.php&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Excel</span>
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * &#x4E00;&#x952E;&#x5BFC; &#x51FA;Excel
     * @param array $header       Excel &#x5934;&#x90E8; [&quot;COL1&quot;,&quot;COL2&quot;,&quot;COL3&quot;,...]
     * @param array $body         &#x548C;&#x5934;&#x90E8;&#x957F;&#x5EA6;&#x76F8;&#x7B49;&#x5B57;&#x6BB5;&#x67E5;&#x8BE2;&#x51FA;&#x7684;&#x6570;&#x636E;&#x5C31;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x5BFC;&#x51FA;
     * @param null|string $name   &#x6587;&#x4EF6;&#x540D;&#xFF0C;&#x4E0D;&#x5305;&#x542B;&#x6269;&#x5C55;&#x540D;&#xFF0C;&#x4E3A;&#x7A7A;&#x9ED8;&#x8BA4;&#x4E3A;&#x5F53;&#x524D;&#x65F6;&#x95F4;
     * @param string|int $version Excel&#x7248;&#x672C; 2003|2007
     * @return string
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">export</span><span class="token punctuation">(</span><span class="token variable">$head</span><span class="token punctuation">,</span> <span class="token variable">$body</span><span class="token punctuation">,</span> <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">,</span> <span class="token variable">$version</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;2007&apos;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// &#x8F93;&#x51FA; Excel &#x6587;&#x4EF6;&#x5934;</span>
            <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">date</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;YmdHis&apos;</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token variable">$name</span><span class="token punctuation">;</span>

            <span class="token variable">$objPHPExcel</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>PHPExcel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$sheetPHPExcel</span> <span class="token operator">=</span> <span class="token variable">$objPHPExcel</span><span class="token operator">-&gt;</span><span class="token function">setActiveSheetIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$char_index</span> <span class="token operator">=</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;A&quot;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// Excel &#x8868;&#x683C;&#x5934;</span>
            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$head</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=&gt;</span> <span class="token variable">$val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token variable">$sheetPHPExcel</span><span class="token operator">-&gt;</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$char_index</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>1&quot;</span><span class="token punctuation">,</span> <span class="token variable">$val</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// Excel body &#x90E8;&#x5206;</span>
            <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$body</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=&gt;</span> <span class="token variable">$val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$key</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>
                <span class="token variable">$col</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$val</span> <span class="token keyword">as</span> <span class="token variable">$k</span> <span class="token operator">=&gt;</span> <span class="token variable">$v</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token variable">$sheetPHPExcel</span><span class="token operator">-&gt;</span><span class="token function">setCellValue</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;<span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$char_index</span><span class="token punctuation">[</span><span class="token variable">$col</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$row</span><span class="token punctuation">}</span></span>&quot;</span><span class="token punctuation">,</span> <span class="token variable">$v</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token variable">$col</span><span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// &#x7248;&#x672C;&#x5DEE;&#x5F02;&#x4FE1;&#x606F;</span>
            <span class="token variable">$version_opt</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
                <span class="token string single-quoted-string">&apos;2007&apos;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span>
                    <span class="token string single-quoted-string">&apos;mime&apos;</span>       <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&apos;</span><span class="token punctuation">,</span>
                    <span class="token string single-quoted-string">&apos;ext&apos;</span>        <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;.xlsx&apos;</span><span class="token punctuation">,</span>
                    <span class="token string single-quoted-string">&apos;write_type&apos;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;Excel2007&apos;</span><span class="token punctuation">,</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string single-quoted-string">&apos;2003&apos;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&apos;mime&apos;</span>       <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.ms-excel&apos;</span><span class="token punctuation">,</span>
                           <span class="token string single-quoted-string">&apos;ext&apos;</span>        <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;.xls&apos;</span><span class="token punctuation">,</span>
                           <span class="token string single-quoted-string">&apos;write_type&apos;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;Excel5&apos;</span><span class="token punctuation">,</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string single-quoted-string">&apos;pdf&apos;</span>  <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&apos;mime&apos;</span>       <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/pdf&apos;</span><span class="token punctuation">,</span>
                           <span class="token string single-quoted-string">&apos;ext&apos;</span>        <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;.pdf&apos;</span><span class="token punctuation">,</span>
                           <span class="token string single-quoted-string">&apos;write_type&apos;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;PDF&apos;</span><span class="token punctuation">,</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token string single-quoted-string">&apos;ods&apos;</span>  <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">&apos;mime&apos;</span>       <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;application/vnd.oasis.opendocument.spreadsheet&apos;</span><span class="token punctuation">,</span>
                           <span class="token string single-quoted-string">&apos;ext&apos;</span>        <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;.ods&apos;</span><span class="token punctuation">,</span>
                           <span class="token string single-quoted-string">&apos;write_type&apos;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&apos;OpenDocument&apos;</span><span class="token punctuation">,</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">;</span>

            <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;Content-Type: &apos;</span> <span class="token operator">.</span> <span class="token variable">$version_opt</span><span class="token punctuation">[</span><span class="token variable">$version</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&apos;mime&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;Content-Disposition: attachment;filename=&quot;&apos;</span> <span class="token operator">.</span> <span class="token variable">$name</span> <span class="token operator">.</span> <span class="token variable">$version_opt</span><span class="token punctuation">[</span><span class="token variable">$version</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&apos;ext&apos;</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&apos;&quot;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;Cache-Control: max-age=0&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// If you&apos;re serving to IE 9, then the following may be needed</span>
            <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;Cache-Control: max-age=1&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// If you&apos;re serving to IE over SSL, then the following may be needed</span>
            <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;Expires: Mon, 26 Jul 1997 05:00:00 GMT&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Date in the past</span>
            <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;Last-Modified: &apos;</span> <span class="token operator">.</span> <span class="token function">gmdate</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;D, d M Y H:i:s&apos;</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">&apos; GMT&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// always modified</span>
            <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;Cache-Control: cache, must-revalidate&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// HTTP/1.1</span>
            <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;Pragma: public&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// HTTP/1.0</span>

            <span class="token variable">$objWriter</span> <span class="token operator">=</span> <span class="token class-name static-context">PHPExcel_IOFactory</span><span class="token operator">::</span><span class="token function">createWriter</span><span class="token punctuation">(</span><span class="token variable">$objPHPExcel</span><span class="token punctuation">,</span> <span class="token variable">$version_opt</span><span class="token punctuation">[</span><span class="token variable">$version</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&apos;write_type&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$objWriter</span><span class="token operator">-&gt;</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;php://output&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token variable">$e</span><span class="token operator">-&gt;</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * &#x89E3;&#x6790; Excel &#x6570;&#x636E;&#x5E76;&#x5199;&#x5165;&#x5230;&#x6570;&#x636E;&#x5E93;
     * @param string $file Excel &#x8DEF;&#x5F84;&#x540D;&#x6587;&#x4EF6;&#x540D;
     * @param array $header &#x8868;&#x5934;&#x5BF9;&#x5E94;&#x5B57;&#x6BB5;&#x4FE1;&#x606F; [&apos;A&apos;=&gt;&apos;field1&apos;, &apos;B&apos;=&gt;&apos;field2&apos;, ...]
     * @param int $perLimit &#x6BCF;&#x6B21;&#x4E00;&#x6B21;&#x6027;&#x5199;&#x5165;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x7684;&#x884C;&#x6570;
     * @param mixed $insertFunc &#x5199;&#x5165;&#x6570;&#x636E;&#x5E93;&#x7684;&#x56DE;&#x8C03;&#x51FD;&#x6570;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x533F;&#x540D;&#x51FD;&#x6570;
     * @param string $type Excel2007|Excel5
     * @return int
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">parse</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token variable">$header</span><span class="token punctuation">,</span> <span class="token variable">$perLimit</span><span class="token punctuation">,</span> <span class="token variable">$insertFunc</span><span class="token punctuation">,</span> <span class="token variable">$type</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;&apos;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$type</span> <span class="token operator">=</span> <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$objReader</span> <span class="token operator">=</span> <span class="token class-name static-context">PHPExcel_IOFactory</span><span class="token operator">::</span><span class="token function">createReader</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$objPHPExcel</span> <span class="token operator">=</span> <span class="token variable">$objReader</span><span class="token operator">-&gt;</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// &#x6570;&#x636E;&#x6570;&#x7EC4;</span>
        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">// &#x5DF2;&#x5BFC;&#x5165;&#x6570;&#x636E;&#x8BA1;&#x6570;</span>
        <span class="token variable">$count</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token comment">// &#x8DF3;&#x8FC7;&#x7B2C;&#x4E00;&#x884C;</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$objPHPExcel</span><span class="token operator">-&gt;</span><span class="token function">getSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getRowIterator</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$row</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// &#x9010;&#x4E2A;&#x5355;&#x5143;&#x683C;&#x8BFB;&#x53D6;&#xFF0C;&#x51CF;&#x5C11;&#x5185;&#x5B58;&#x6D88;&#x8017;</span>
            <span class="token variable">$cellIterator</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token operator">-&gt;</span><span class="token function">getCellIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// &#x4E0D;&#x8DF3;&#x8FC7;&#x7A7A;&#x503C;</span>
            <span class="token variable">$cellIterator</span><span class="token operator">-&gt;</span><span class="token function">setIterateOnlyExistingCells</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// &#x53EA;&#x8BFB;&#x53D6;&#x663E;&#x793A;&#x7684;&#x884C;&#x3001;&#x5217;&#xFF0C;&#x8DF3;&#x8FC7;&#x9690;&#x85CF;&#x884C;&#x3001;&#x5217;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$objPHPExcel</span><span class="token operator">-&gt;</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getRowDimension</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token operator">-&gt;</span><span class="token function">getRowIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getVisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token variable">$rowData</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$cellIterator</span> <span class="token keyword">as</span> <span class="token variable">$cell</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$objPHPExcel</span><span class="token operator">-&gt;</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getColumnDimension</span><span class="token punctuation">(</span><span class="token variable">$cell</span><span class="token operator">-&gt;</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getVisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$header</span><span class="token punctuation">[</span><span class="token variable">$cell</span><span class="token operator">-&gt;</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token variable">$rowData</span><span class="token punctuation">[</span><span class="token variable">$header</span><span class="token punctuation">[</span><span class="token variable">$cell</span><span class="token operator">-&gt;</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$cell</span><span class="token operator">-&gt;</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$rowData</span><span class="token punctuation">;</span>
                <span class="token variable">$count</span><span class="token operator">++</span><span class="token punctuation">;</span>
                <span class="token comment">// &#x6570;&#x636E;&#x5206;&#x6279;&#x5199;&#x5165;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x9632;&#x6B62;&#x4E00;&#x6761;SQL&#x592A;&#x957F;&#x6570;&#x636E;&#x5E93;&#x4E0D;&#x652F;&#x6301;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$count</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$count</span> <span class="token operator">%</span> <span class="token variable">$perLimit</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token variable">$insertFunc</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// &#x6E05;&#x7A7A;&#x5DF2;&#x6709;&#x6570;&#x636E;</span>
                    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// &#x5199;&#x5165;&#x5269;&#x4F59;&#x6570;&#x636E;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$insertFunc</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token variable">$count</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">/**
     * &#x89E3;&#x6790; Excel &#x83B7;&#x53D6;&#x7B2C;&#x4E00;&#x884C;&#x5934;&#x4FE1;&#x606F;
     * @param string $file Excel &#x8DEF;&#x5F84;&#x540D;&#x6587;&#x4EF6;&#x540D;
     * @param string $type Excel2007|Excel5
     * @return array
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">parseHeader</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token variable">$type</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;&apos;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$type</span> <span class="token operator">=</span> <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$objReader</span> <span class="token operator">=</span> <span class="token class-name static-context">PHPExcel_IOFactory</span><span class="token operator">::</span><span class="token function">createReader</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$objPHPExcel</span> <span class="token operator">=</span> <span class="token variable">$objReader</span><span class="token operator">-&gt;</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$header</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$objPHPExcel</span><span class="token operator">-&gt;</span><span class="token function">getSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getRowIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$row</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// &#x9010;&#x4E2A;&#x5355;&#x5143;&#x683C;&#x8BFB;&#x53D6;&#xFF0C;&#x51CF;&#x5C11;&#x5185;&#x5B58;&#x6D88;&#x8017;</span>
            <span class="token variable">$cellIterator</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token operator">-&gt;</span><span class="token function">getCellIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// &#x4E0D;&#x8DF3;&#x8FC7;&#x7A7A;&#x503C;</span>
            <span class="token variable">$cellIterator</span><span class="token operator">-&gt;</span><span class="token function">setIterateOnlyExistingCells</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$objPHPExcel</span><span class="token operator">-&gt;</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getRowDimension</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token operator">-&gt;</span><span class="token function">getRowIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getVisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$cellIterator</span> <span class="token keyword">as</span> <span class="token variable">$cell</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$objPHPExcel</span><span class="token operator">-&gt;</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getColumnDimension</span><span class="token punctuation">(</span><span class="token variable">$cell</span><span class="token operator">-&gt;</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getVisible</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token variable">$header</span><span class="token punctuation">[</span><span class="token variable">$cell</span><span class="token operator">-&gt;</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$cell</span><span class="token operator">-&gt;</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token variable">$header</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * &#x81EA;&#x52A8;&#x83B7;&#x53D6; Excel &#x7C7B;&#x578B;
     * @param string $file Excel &#x8DEF;&#x5F84;&#x540D;&#x6587;&#x4EF6;&#x540D;
     * @param string $type Excel2007|Excel5
     * @return string
     * @throws Exception
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">getType</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token variable">$type</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;&apos;</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">pathinfo</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token constant">PATHINFO_EXTENSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">case</span> <span class="token string single-quoted-string">&apos;xls&apos;</span> <span class="token punctuation">:</span>
                    <span class="token variable">$type</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;Excel5&apos;</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token string single-quoted-string">&apos;xlsx&apos;</span> <span class="token punctuation">:</span>
                    <span class="token variable">$type</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;Excel2007&apos;</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token keyword">default</span><span class="token punctuation">:</span>
                    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;&#x8BF7;&#x6307;&#x5B9A;Excel&#x7684;&#x7C7B;&#x578B;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token variable">$type</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * &#x5C06; Excel &#x65F6;&#x95F4;&#x8F6C;&#x4E3A;&#x6807;&#x51C6;&#x7684;&#x65F6;&#x95F4;&#x683C;&#x5F0F;
     * @param $date
     * @param bool $time
     * @return array|int|string
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">excelTime</span><span class="token punctuation">(</span><span class="token variable">$date</span><span class="token punctuation">,</span> <span class="token variable">$time</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">function_exists</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;GregorianToJD&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$date</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token variable">$jd</span> <span class="token operator">=</span> <span class="token function">GregorianToJD</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1970</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token variable">$gregorian</span> <span class="token operator">=</span> <span class="token function">JDToGregorian</span><span class="token punctuation">(</span><span class="token variable">$jd</span> <span class="token operator">+</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$date</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">25569</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token variable">$date</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&apos;/&apos;</span><span class="token punctuation">,</span> <span class="token variable">$gregorian</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token variable">$date_str</span> <span class="token operator">=</span> <span class="token function">str_pad</span><span class="token punctuation">(</span><span class="token variable">$date</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;0&apos;</span><span class="token punctuation">,</span> <span class="token constant">STR_PAD_LEFT</span><span class="token punctuation">)</span>
                    <span class="token operator">.</span> <span class="token string double-quoted-string">&quot;-&quot;</span> <span class="token operator">.</span> <span class="token function">str_pad</span><span class="token punctuation">(</span><span class="token variable">$date</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;0&apos;</span><span class="token punctuation">,</span> <span class="token constant">STR_PAD_LEFT</span><span class="token punctuation">)</span>
                    <span class="token operator">.</span> <span class="token string double-quoted-string">&quot;-&quot;</span> <span class="token operator">.</span> <span class="token function">str_pad</span><span class="token punctuation">(</span><span class="token variable">$date</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">&apos;0&apos;</span><span class="token punctuation">,</span> <span class="token constant">STR_PAD_LEFT</span><span class="token punctuation">)</span>
                    <span class="token operator">.</span> <span class="token punctuation">(</span><span class="token variable">$time</span> <span class="token operator">?</span> <span class="token string double-quoted-string">&quot; 00:00:00&quot;</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">&apos;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">return</span> <span class="token variable">$date_str</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token variable">$date</span> <span class="token operator">=</span> <span class="token variable">$date</span> <span class="token operator">&gt;</span> <span class="token number">25568</span> <span class="token operator">?</span> <span class="token variable">$date</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">:</span> <span class="token number">25569</span><span class="token punctuation">;</span>
            <span class="token variable">$ofs</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">70</span> <span class="token operator">*</span> <span class="token number">365</span> <span class="token operator">+</span> <span class="token number">17</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">86400</span><span class="token punctuation">;</span>
            <span class="token variable">$date</span> <span class="token operator">=</span> <span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Y-m-d&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token variable">$date</span> <span class="token operator">*</span> <span class="token number">86400</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token variable">$ofs</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token punctuation">(</span><span class="token variable">$time</span> <span class="token operator">?</span> <span class="token string double-quoted-string">&quot; 00:00:00&quot;</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">&apos;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token variable">$date</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li>&#x8BFB;&#x53D6;Excel&#x6587;&#x4EF6;</li>
</ul>
<pre class="language-"><code class="lang-php"><span class="token variable">$fileName</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;url.xls&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$fileName</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;&#x6587;&#x4EF6;&quot;</span><span class="token operator">.</span><span class="token variable">$fileName</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;&#x4E0D;&#x5B58;&#x5728;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>


<span class="token keyword">require_once</span> <span class="token string single-quoted-string">&apos;./PHPExcel/IOFactory.php&apos;</span><span class="token punctuation">;</span>

<span class="token variable">$objPHPExcel</span> <span class="token operator">=</span> <span class="token class-name static-context">PHPExcel_IOFactory</span><span class="token operator">::</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token variable">$fileName</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//&#x83B7;&#x53D6;sheet&#x8868;&#x683C;&#x6570;&#x76EE;</span>
<span class="token variable">$sheetCount</span> <span class="token operator">=</span> <span class="token variable">$objPHPExcel</span><span class="token operator">-&gt;</span><span class="token function">getSheetCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//&#x9ED8;&#x8BA4;&#x9009;&#x4E2D;sheet0&#x8868;</span>
<span class="token variable">$sheetSelected</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token variable">$objPHPExcel</span><span class="token operator">-&gt;</span><span class="token function">setActiveSheetIndex</span><span class="token punctuation">(</span><span class="token variable">$sheetSelected</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//&#x83B7;&#x53D6;&#x8868;&#x683C;&#x884C;&#x6570;</span>
<span class="token variable">$rowCount</span> <span class="token operator">=</span> <span class="token variable">$objPHPExcel</span><span class="token operator">-&gt;</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getHighestRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//&#x83B7;&#x53D6;&#x8868;&#x683C;&#x5217;&#x6570;</span>
<span class="token variable">$columnCount</span> <span class="token operator">=</span> <span class="token variable">$objPHPExcel</span><span class="token operator">-&gt;</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getHighestColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;&lt;div&gt;Sheet Count : &quot;</span><span class="token operator">.</span><span class="token variable">$sheetCount</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;&#x3000;&#x3000;&#x884C;&#x6570;&#xFF1A; &quot;</span><span class="token operator">.</span><span class="token variable">$rowCount</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;&#x3000;&#x3000;&#x5217;&#x6570;&#xFF1A;&quot;</span><span class="token operator">.</span><span class="token variable">$columnCount</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;&lt;/div&gt;&quot;</span><span class="token punctuation">;</span>

<span class="token variable">$dataArr</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">/* &#x5FAA;&#x73AF;&#x8BFB;&#x53D6;&#x6BCF;&#x4E2A;&#x5355;&#x5143;&#x683C;&#x7684;&#x6570;&#x636E; */</span>
<span class="token comment">//&#x884C;&#x6570;&#x5FAA;&#x73AF;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token variable">$row</span> <span class="token operator">&lt;=</span> <span class="token variable">$rowCount</span><span class="token punctuation">;</span> <span class="token variable">$row</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token comment">//&#x5217;&#x6570;&#x5FAA;&#x73AF; , &#x5217;&#x6570;&#x662F;&#x4EE5;A&#x5217;&#x5F00;&#x59CB;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$column</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&apos;A&apos;</span><span class="token punctuation">;</span> <span class="token variable">$column</span> <span class="token operator">&lt;=</span> <span class="token variable">$columnCount</span><span class="token punctuation">;</span> <span class="token variable">$column</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token variable">$dataArr</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$objPHPExcel</span><span class="token operator">-&gt;</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token variable">$column</span><span class="token operator">.</span><span class="token variable">$row</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token variable">$column</span><span class="token operator">.</span><span class="token variable">$row</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;:&quot;</span><span class="token operator">.</span><span class="token variable">$objPHPExcel</span><span class="token operator">-&gt;</span><span class="token function">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token variable">$column</span><span class="token operator">.</span><span class="token variable">$row</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;&lt;br /&gt;&quot;</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;&lt;br/&gt;&#x6D88;&#x8017;&#x7684;&#x5185;&#x5B58;&#x4E3A;&#xFF1A;&quot;</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token function">memory_get_peak_usage</span><span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;M&quot;</span><span class="token punctuation">;</span>

    <span class="token variable">$endTime</span> <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;&lt;div&gt;&#x89E3;&#x6790;&#x5B8C;&#x540E;&#xFF0C;&#x5F53;&#x524D;&#x7684;&#x65F6;&#x95F4;&#x4E3A;&#xFF1A;&quot;</span><span class="token operator">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Y-m-d H:i:s&quot;</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;&#x3000;&#x3000;&#x3000;

    &#x603B;&#x5171;&#x6D88;&#x8017;&#x7684;&#x65F6;&#x95F4;&#x4E3A;&#xFF1A;&quot;</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$endTime</span> <span class="token operator">-</span> <span class="token variable">$startTime</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;&#x79D2;&lt;/div&gt;&quot;</span><span class="token punctuation">;</span>

    <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$dataArr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$dataArr</span> <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<footer class="page-footer-ex"> <span class="page-footer-ex-copyright"> <a href="https://github.com/lanlangdeai" target="_blank">lanlangdeai</a> </span> &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span class="page-footer-ex-footer-update"> <i>updated</i> 2021-07-08 18:53:54 </span> </footer>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="files.html" class="navigation navigation-prev " aria-label="Previous page: 文件类">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="composer.html" class="navigation navigation-next " aria-label="Next page: 第三方包">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"常用类","level":"1.2.2","depth":2,"next":{"title":"第三方包","level":"1.2.3","depth":2,"path":"php/composer.md","ref":"php/composer.md","articles":[]},"previous":{"title":"文件类","level":"1.2.1.1","depth":3,"path":"php/files.md","ref":"php/files.md","articles":[]},"dir":"ltr"},"config":{"plugins":["expandable-chapters-small","anchors","github","baidu-tongji-with-multiple-channel","copy-code-button","anchor-navigation-ex","prism","splitter","page-footer-ex","sharing","codeblock-filename","-mathjax","multipart","bootstrap-callout","theme-comscore","-rss","-lunr","-search","search-pro","-highlight","-github-buttons","-donate","-sharing-plus","-favicon","-ga","-editlink"],"styles":{"website":"./styles/website.css"},"pluginsConfig":{"prism":{},"github":{"url":"https://github.com/lanlangdeai/Gitbook.git"},"baidu-tongji-with-multiple-channel":{"multipleChannelConfig":{},"url":"https://hm.baidu.com/hm.js","token":"30a114d157d9edf0514ba584936c649d"},"page-footer-ex":{"copyright":"[lanlangdeai](https://github.com/lanlangdeai)","markdown":true,"update_format":"YYYY-MM-DD HH:mm:ss","update_label":"<i>updated</i>"},"splitter":{},"search-pro":{},"multipart":{},"bootstrap-callout":{},"fontsettings":{"theme":"white","family":"sans","size":2},"anchor-navigation-ex":{"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":false,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":true},"codeblock-filename":{},"theme-comscore":{},"expandable-chapters-small":{},"copy-code-button":{},"sharing":{"all":["weibo","google","twitter","weibo","instapaper"],"facebook":false,"google":false,"instapaper":false,"twitter":false,"vk":false,"weibo":false},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":true},"anchors":{}},"theme":"default","author":"X-Wolf","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"LanLang's Gitbook","language":"zh-hans","gitbook":"3.2.3","description":"多种技术知识点汇总，方便后期查看"},"file":{"path":"php/classes.md","mtime":"2021-07-08T10:53:54.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-12-13T09:46:32.401Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-baidu-tongji-with-multiple-channel/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-theme-comscore/test.js"></script>
        
    

    </body>
</html>

